<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AES Encryption</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="../style/style.css">
<link rel="stylesheet" href="../style/main.css">
  <link rel="stylesheet" href="./assets/style/main.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

</head>
<body>

    <main class="main-content-wrapper">
            <header>
        <div class="header-wrapper">
  <div class="container-default w-container">
    <div class="header-content-wrapper">

      <div class="header-left-side">
        <a href="https://3mmarx3.github.io/Cryptography/" class="header-logo-link w-nav-brand">
          <img src="https://cdn.prod.website-files.com/64d2cc2d27b51cf1b517c011/6616b1c13ffb5841a23a15ea_logo-cryptoverse-x-webflow-template.png" alt="Logo - Cryptoverse X Webflow Template">
        </a>

        <nav class="header-nav-menu-wrapper">
          <ul class="header-nav-menu-list">
            <li class="header-nav-list-item">
              <a href="https://3mmarx3.github.io/Cryptography/" class="header-nav-link">Home</a>
            </li>
            <li class="header-nav-list-item">
              <a href="https://eng-ammar.com/page/about.php" class="header-nav-link">About</a>
            </li>
            <li class="header-nav-list-item">
              <a href="https://eng-ammar.com/page/project.php" class="header-nav-link">Blog</a>
            </li>
            <li class="header-nav-list-item">
              <a href="https://eng-ammar.com" class="btn-primary small w-button">Get started</a>
            </li>
          </ul>
        </nav>
      </div>

<div class="header-right-side">
  <div class="social-media-links-container">
    <a href="https://www.facebook.com/3mmarx3/" target="_blank" class="social-link-single" aria-label="Facebook">
      <i class="bi bi-facebook" aria-hidden="true"></i>
    </a>

    <a href="https://www.instagram.com/3mmarx3/" target="_blank" class="social-link-single" aria-label="Instagram">
      <i class="bi bi-instagram" aria-hidden="true"></i>
    </a>
    <a href="https://www.linkedin.com/in/eng-ammar-ahmed/" target="_blank" class="social-link-single" aria-label="LinkedIn">
      <i class="bi bi-linkedin" aria-hidden="true"></i>
    </a>
  </div>
</div>

    </div>
  </div>
</div>
  </header>


<div class="card">
  <h1>Playfair Cipher</h1>
  <label for="keyword">Keyword</label>
  <input id="keyword" placeholder="Enter keyword">
  <label for="message">Message</label>
  <textarea id="message" placeholder="Letters only"></textarea>
  <button onclick="encrypt()">Encrypt</button>
  <div class="box" id="encrypted"></div>
  <button onclick="decrypt()">Decrypt</button>
  <div class="box" id="decrypted">—</div>
  <div class="footer">Educational Playfair Cipher</div>
</div>

</main>
<script>
function prepareText(text){
  text=text.toUpperCase().replace(/[^A-Z]/g,'').replace(/J/g,'I');
  let res='';
  for(let i=0;i<text.length;i++){
    res+=text[i];
    if(text[i+1]===text[i]) res+='X';
  }
  if(res.length%2!==0) res+='X';
  return res;
}
function generateMatrix(keyword){
  keyword=keyword.toUpperCase().replace(/J/g,'I').replace(/[^A-Z]/g,'');
  let seen={},matrix=[];
  for(let c of keyword) if(!seen[c]){matrix.push(c); seen[c]=true;}
  for(let i=65;i<=90;i++){
    let ch=String.fromCharCode(i);
    if(ch==='J') continue;
    if(!seen[ch]){matrix.push(ch); seen[ch]=true;}
  }
  let grid=[];
  for(let i=0;i<5;i++) grid.push(matrix.slice(i*5,i*5+5));
  return grid;
}
function findPosition(grid,ch){
  for(let i=0;i<5;i++){
    for(let j=0;j<5;j++){
      if(grid[i][j]===ch) return [i,j];
    }
  }
  return null;
}
function playfairEncrypt(text,grid){
  let prepared=prepareText(text);
  let res='';
  for(let i=0;i<prepared.length;i+=2){
    let a=prepared[i],b=prepared[i+1];
    let [r1,c1]=findPosition(grid,a);
    let [r2,c2]=findPosition(grid,b);
    if(r1===r2){res+=grid[r1][(c1+1)%5]+grid[r2][(c2+1)%5];}
    else if(c1===c2){res+=grid[(r1+1)%5][c1]+grid[(r2+1)%5][c2];}
    else{res+=grid[r1][c2]+grid[r2][c1];}
  }
  return res;
}
function playfairDecrypt(text,grid){
  let res='';
  for(let i=0;i<text.length;i+=2){
    let a=text[i],b=text[i+1];
    let [r1,c1]=findPosition(grid,a);
    let [r2,c2]=findPosition(grid,b);
    if(r1===r2){res+=grid[r1][(c1+4)%5]+grid[r2][(c2+4)%5];}
    else if(c1===c2){res+=grid[(r1+4)%5][c1]+grid[(r2+4)%5][c2];}
    else{res+=grid[r1][c2]+grid[r2][c1];}
  }
  return res;
}
function encrypt(){
  let keyword=document.getElementById("keyword").value;
  let text=document.getElementById("message").value;
  if(!keyword) return alert("Enter a keyword");
  if(!text) return alert("Enter a message");
  let grid=generateMatrix(keyword);
  document.getElementById("encrypted").textContent=playfairEncrypt(text,grid);
  document.getElementById("decrypted").textContent="—";
}
function decrypt(){
  let keyword=document.getElementById("keyword").value;
  let cipher=document.getElementById("encrypted").textContent;
  if(!keyword) return alert("Enter a keyword");
  if(!cipher) return alert("Encrypt a message first");
  let grid=generateMatrix(keyword);
  document.getElementById("decrypted").textContent=playfairDecrypt(cipher,grid);
}
</script>
</body>
</html>
